{"version":3,"file":"react-imask.js","sources":["../src/mixin.js","../src/input.js"],"sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport IMask from 'imask/esm/imask';\r\n\r\n\r\nconst MASK_PROPS = {\r\n  // common\r\n  mask: PropTypes.oneOfType([\r\n    PropTypes.array,\r\n    PropTypes.func,\r\n    PropTypes.string,\r\n    PropTypes.instanceOf(RegExp),\r\n    PropTypes.oneOf([Date, Number, IMask.Masked]),\r\n    PropTypes.instanceOf(IMask.Masked),\r\n  ]),\r\n  value: PropTypes.any,\r\n  unmask: PropTypes.oneOfType([\r\n    PropTypes.bool,\r\n    PropTypes.oneOf(['typed']),\r\n  ]),\r\n  prepare: PropTypes.func,\r\n  validate: PropTypes.func,\r\n  commit: PropTypes.func,\r\n  overwrite: PropTypes.bool,\r\n\r\n  // events\r\n  onAccept: PropTypes.func,\r\n  onComplete: PropTypes.func,\r\n\r\n  // pattern\r\n  placeholderChar: PropTypes.string,\r\n  lazy: PropTypes.bool,\r\n  definitions: PropTypes.object,\r\n  blocks: PropTypes.object,\r\n\r\n  // date\r\n  pattern: PropTypes.string,\r\n  format: PropTypes.func,\r\n  parse: PropTypes.func,\r\n  autofix: PropTypes.bool,\r\n\r\n  // number\r\n  radix: PropTypes.string,\r\n  thousandsSeparator: PropTypes.string,\r\n  mapToRadix: PropTypes.arrayOf(PropTypes.string),\r\n  scale: PropTypes.number,\r\n  signed: PropTypes.bool,\r\n  normalizeZeros: PropTypes.bool,\r\n  padFractionalZeros: PropTypes.bool,\r\n  min: PropTypes.oneOfType([\r\n    PropTypes.number,\r\n    PropTypes.instanceOf(Date),\r\n  ]),\r\n  max: PropTypes.oneOfType([\r\n    PropTypes.number,\r\n    PropTypes.instanceOf(Date),\r\n  ]),\r\n\r\n  // dynamic\r\n  dispatch: PropTypes.func,\r\n\r\n  // ref\r\n  inputRef: PropTypes.func\r\n};\r\n\r\nconst MASK_PROPS_NAMES = Object.keys(MASK_PROPS);\r\nconst NON_MASK_OPTIONS_PROPS_NAMES = ['value', 'unmask', 'onAccept', 'onComplete', 'inputRef'];\r\nconst MASK_OPTIONS_PROPS_NAMES = MASK_PROPS_NAMES.filter(pName =>\r\n  NON_MASK_OPTIONS_PROPS_NAMES.indexOf(pName) < 0\r\n);\r\n\r\nexport default\r\nfunction IMaskMixin(ComposedComponent) {\r\n  const MaskedComponent = class extends React.Component {\r\n    constructor (...args) {\r\n      super(...args);\r\n      this._inputRef = this._inputRef.bind(this);\r\n    }\r\n\r\n    componentDidMount () {\r\n      if (!this.props.mask) return;\r\n\r\n      this.initMask();\r\n    }\r\n\r\n    componentDidUpdate () {\r\n      const props = this.props;\r\n      const maskOptions = this._extractMaskOptionsFromProps(props);\r\n      if (maskOptions.mask) {\r\n        if (this.maskRef) {\r\n          this.maskRef.updateOptions(maskOptions);\r\n          if ('value' in props &&\r\n            (props.value !== this.maskValue ||\r\n              // handle cases like Number('') === 0,\r\n              // for details see https://github.com/uNmAnNeR/imaskjs/issues/134\r\n              (typeof props.value !== 'string' && this.maskRef.value === '') &&\r\n                !this.maskRef.el.isActive)\r\n          ) {\r\n            this.maskValue = props.value;\r\n          }\r\n        } else {\r\n          this.initMask(maskOptions);\r\n          if (props.value !== this.maskValue) this._onAccept();\r\n        }\r\n      } else {\r\n        this.destroyMask();\r\n        if ('value' in props) this.element.value = props.value;\r\n      }\r\n    }\r\n\r\n    componentWillUnmount () {\r\n      this.destroyMask();\r\n    }\r\n\r\n    _inputRef (el) {\r\n      this.element = el;\r\n      if (this.props.inputRef) this.props.inputRef(el);\r\n    }\r\n\r\n    render () {\r\n      return React.createElement(ComposedComponent, {\r\n        ...this._extractNonMaskProps(this.props),\r\n        defaultValue: this.props.value,\r\n        inputRef: this._inputRef,\r\n      });\r\n    }\r\n\r\n    initMask (maskOptions=this._extractMaskOptionsFromProps({...this.props})) {\r\n      this.maskRef = IMask(this.element, maskOptions)\r\n        .on('accept', this._onAccept.bind(this))\r\n        .on('complete', this._onComplete.bind(this));\r\n\r\n      this.maskValue = this.props.value;\r\n    }\r\n\r\n    destroyMask () {\r\n      if (this.maskRef) {\r\n        this.maskRef.destroy();\r\n        delete this.maskRef;\r\n      }\r\n    }\r\n\r\n    _extractMaskOptionsFromProps (props) {\r\n      props = {...props};\r\n\r\n      // keep only mask options props\r\n      Object.keys(props)\r\n        .filter(prop => MASK_OPTIONS_PROPS_NAMES.indexOf(prop) < 0)\r\n        .forEach(nonMaskProp => {\r\n          delete props[nonMaskProp];\r\n        });\r\n\r\n      return props;\r\n    }\r\n\r\n    _extractNonMaskProps (props) {\r\n      props = {...props};\r\n\r\n      MASK_PROPS_NAMES.forEach(maskProp => {\r\n        delete props[maskProp];\r\n      });\r\n\r\n      return props;\r\n    }\r\n\r\n    get maskValue () {\r\n      if (this.props.unmask === 'typed') return this.maskRef.typedValue;\r\n      if (this.props.unmask) return this.maskRef.unmaskedValue;\r\n      return this.maskRef.value;\r\n    }\r\n\r\n    set maskValue (value) {\r\n      value = value == null ? '' : value;\r\n      if (this.props.unmask === 'typed') this.maskRef.typedValue = value;\r\n      else if (this.props.unmask) this.maskRef.unmaskedValue = value;\r\n      else this.maskRef.value = value;\r\n    }\r\n\r\n    _onAccept (...args) {\r\n      if (this.props.onAccept) this.props.onAccept(this.maskValue, this.maskRef, ...args);\r\n    }\r\n\r\n    _onComplete (...args) {\r\n      if (this.props.onComplete) this.props.onComplete(this.maskValue, this.maskRef, ...args);\r\n    }\r\n  };\r\n\r\n  MaskedComponent.propTypes = MASK_PROPS;\r\n\r\n  const nestedComponentName = ComposedComponent.displayName || ComposedComponent.name || 'Component';\r\n  MaskedComponent.displayName = `IMask(${nestedComponentName})`;\r\n\r\n  return MaskedComponent;\r\n}\r\n","import React from 'react';\r\nimport IMaskMixin from './mixin';\r\n\r\n\r\nconst InputComponent = ({inputRef, ...props}) =>\r\n  React.createElement('input', {\r\n    ...props,\r\n    ref: inputRef\r\n  });\r\n\r\n\r\nconst IMaskInput = IMaskMixin(InputComponent);\r\nexport default IMaskInput;\r\n"],"names":["MASK_PROPS","mask","PropTypes","oneOfType","array","func","string","instanceOf","RegExp","oneOf","Date","Number","IMask","Masked","value","any","unmask","bool","prepare","validate","commit","overwrite","onAccept","onComplete","placeholderChar","lazy","definitions","object","blocks","pattern","format","parse","autofix","radix","thousandsSeparator","mapToRadix","arrayOf","scale","number","signed","normalizeZeros","padFractionalZeros","min","max","dispatch","inputRef","MASK_PROPS_NAMES","Object","keys","NON_MASK_OPTIONS_PROPS_NAMES","MASK_OPTIONS_PROPS_NAMES","filter","pName","indexOf","IMaskMixin","ComposedComponent","MaskedComponent","args","_inputRef","bind","props","initMask","maskOptions","_extractMaskOptionsFromProps","maskRef","updateOptions","maskValue","el","isActive","_onAccept","destroyMask","element","React","createElement","_extractNonMaskProps","defaultValue","on","_onComplete","destroy","prop","forEach","nonMaskProp","maskProp","typedValue","unmaskedValue","Component","propTypes","nestedComponentName","displayName","name","InputComponent","ref","IMaskInput"],"mappings":"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"}